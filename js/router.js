const loaderAnimationData = {
  "v":"5.8.1","fr":30,"ip":0,"op":33,"w":1920,"h":1080,"nm":"Comp 1","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Shape Layer 5","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"k":[{"s":[1200,472.81,0],"t":0,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,538.525,0],"t":1,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,603.615,0],"t":2,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,658.732,0],"t":3,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,705.957,0],"t":4,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,748.299,0],"t":5,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,787.497,0],"t":6,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,824.536,0],"t":7,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,860,0],"t":8,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,837.624,0],"t":9,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,801.681,0],"t":10,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,764.332,0],"t":11,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,724.315,0],"t":12,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,682.199,0],"t":13,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,643.655,0],"t":14,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,607.961,0],"t":15,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,573.612,0],"t":16,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,540,0],"t":17,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,506.352,0],"t":18,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,471.859,0],"t":19,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,435.787,0],"t":20,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,396.248,0],"t":21,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,351.942,0],"t":22,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,309.615,0],"t":23,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,270.399,0],"t":24,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,232.899,0],"t":25,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,208,0],"t":26,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,244.791,0],"t":27,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,283.209,0],"t":28,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,323.844,0],"t":29,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,367.658,0],"t":30,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,416.366,0],"t":31,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,472.81,0],"t":32,"i":{"x":1,"y":1},"o":{"x":0,"y":0}}],"l":2},"a":{"a":0,"k":[-172,-62,0],"ix":1,"l":2},"s":{"a":0,"k":[190,190,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[60,60],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.901960784314,0.223529411765,0.274509803922,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-172,-62],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":-15,"op":135,"st":-15,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Shape Layer 4","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"k":[{"s":[960,208,0],"t":0,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,244.791,0],"t":1,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,283.209,0],"t":2,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,323.844,0],"t":3,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,367.658,0],"t":4,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,416.366,0],"t":5,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,472.81,0],"t":6,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,538.525,0],"t":7,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,603.615,0],"t":8,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,658.732,0],"t":9,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,705.957,0],"t":10,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,748.299,0],"t":11,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,787.497,0],"t":12,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,824.536,0],"t":13,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,860,0],"t":14,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,837.624,0],"t":15,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,801.681,0],"t":16,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,764.332,0],"t":17,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,724.315,0],"t":18,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,682.199,0],"t":19,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,643.655,0],"t":20,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,607.961,0],"t":21,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,573.612,0],"t":22,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,540,0],"t":23,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,506.352,0],"t":24,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,471.859,0],"t":25,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,435.787,0],"t":26,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,396.248,0],"t":27,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,351.942,0],"t":28,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,309.615,0],"t":29,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,270.399,0],"t":30,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,232.899,0],"t":31,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,208,0],"t":32,"i":{"x":1,"y":1},"o":{"x":0,"y":0}}],"l":2},"a":{"a":0,"k":[-172,-62,0],"ix":1,"l":2},"s":{"a":0,"k":[190,190,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[60,60],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.901960784314,0.223529411765,0.274509803922,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-172,-62],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":-9,"op":141,"st":-9,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"Shape Layer 3","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"k":[{"s":[720,540,0],"t":0,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,506.352,0],"t":1,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,471.859,0],"t":2,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,435.787,0],"t":3,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,396.248,0],"t":4,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,351.942,0],"t":5,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,309.615,0],"t":6,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,270.399,0],"t":7,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,232.899,0],"t":8,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,208,0],"t":9,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,244.791,0],"t":10,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,283.209,0],"t":11,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,323.844,0],"t":12,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,367.658,0],"t":13,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,416.366,0],"t":14,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,472.81,0],"t":15,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,538.525,0],"t":16,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,603.615,0],"t":17,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,658.732,0],"t":18,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,705.957,0],"t":19,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,748.299,0],"t":20,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,787.497,0],"t":21,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,824.536,0],"t":22,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,860,0],"t":23,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,837.624,0],"t":24,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,801.681,0],"t":25,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,764.332,0],"t":26,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,724.315,0],"t":27,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,682.199,0],"t":28,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,643.655,0],"t":29,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,607.961,0],"t":30,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,573.612,0],"t":31,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,540,0],"t":32,"i":{"x":1,"y":1},"o":{"x":0,"y":0}}],"l":2},"a":{"a":0,"k":[-172,-62,0],"ix":1,"l":2},"s":{"a":0,"k":[190,190,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[60,60],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.901960784314,0.223529411765,0.274509803922,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-172,-62],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0}],"markers":[]
}

// –ì–ª–æ–±–∞–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ñ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
window.initBurgerMenu = initBurgerMenu

function initBurgerMenu() {
  const burger = document.querySelector('.burger')
  const nav = document.querySelector('nav')
  const navBg = document.querySelector('.nav-bg')
  if (!burger || !nav || !navBg) return

  function closeMenu() {
    nav.classList.remove('open')
    burger.classList.remove('active')
    navBg.classList.remove('visible')
  document.body.classList.remove('no-scroll') // üîì –¥–æ–∑–≤–æ–ª—è—î–º–æ —Å–∫—Ä–æ–ª
  }

  window.closeBurgerMenu = closeMenu // ‚¨ÖÔ∏è –µ–∫—Å–ø–æ—Ä—Ç—É—î–º–æ –≥–ª–æ–±–∞–ª—å–Ω–æ

  burger.addEventListener('click', () => {
    const isOpen = nav.classList.toggle('open')
    burger.classList.toggle('active')
    navBg.classList.toggle('visible', isOpen)
    document.body.classList.toggle('no-scroll', isOpen) // üîí/üîì
  })

  nav.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', event => {
      event.preventDefault()
      // –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é –æ–±—Ä–æ–±–ª—è—î handleNavigation
    })
  })
}





// –î–∞–Ω—ñ –≤—Å—ñ—Ö –ø—Ä–æ—î–∫—Ç—ñ–≤
const projectsData = {
  project1: {
    title: "Umedia video 4/5",
    description: "–ü—Ä–æ—î–∫—Ç –ø—Ä–æ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ–¥–æ–º—É —á–µ—Ä–µ–∑ –ü–∞—Ä–∏–∂. –ú–æ–Ω—Ç–∞–∂, —Ä–∏—Ç–º —ñ –∫–æ–ª—å–æ—Ä–æ–∫–æ—Ä–µ–∫—Ü—ñ—è ‚Äî –º–æ—ó.",
    video: "https://www.youtube.com/embed/uyOvfzflka0?si=3HdUy981Eu7ibGzr",
    image: [
      "assets/projects_images/1project/about_color.png",
      "assets/projects_images/1project/sound_design.png",
      "assets/projects_images/1project/ae.png",
      "assets/projects_images/1project/ae_subtitles.png",
    ]
  },
  project2: {
    title: "Umedia 1 video",
    description: "–ï–º–æ—Ü—ñ–π–Ω–∞ –∫–æ—Ä–æ—Ç–∫–∞ —ñ—Å—Ç–æ—Ä—ñ—è –≤ Instagram-—Å—Ç–∏–ª—ñ. –ü—Ä–∞—Ü—é–≤–∞–≤ –Ω–∞–¥ —Ç–µ–º–ø–æ–º —ñ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏.",
    video: "https://www.youtube.com/embed/Je7Mc7h1PIg?si=lBBGocJjckXOc9eE",
    image: []
  },
}





// –ü–æ–∫–∞–∑–∞—Ç–∏ –º–æ–¥–∞–ª–∫—É
let scrollY = 0

function openModal(data) {
  const modal = document.querySelector('.know-more__block')
  const backdrop = document.querySelector('.know-more__behind')

  modal.querySelector('.know-more__block-h1').textContent = data.title
  modal.querySelector('.know-more__block-description-p').textContent = data.description

  const imagesContainer = modal.querySelector('.know-more__block-images')
  const videoContainer = modal.querySelector('.know-more__block-video')

  // –û—á–∏—Å—Ç–∏—Ç–∏
  videoContainer.innerHTML = ''
  imagesContainer.querySelectorAll('img').forEach(img => img.remove())

  // –î–æ–¥–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
  data.image.forEach((imgSrc) => {
    // –û–±–≥–æ—Ä—Ç–∫–∞
    const wrapper = document.createElement('div')
    wrapper.classList.add('know-more__block-image-wrapper')

    // Lottie –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    const loader = document.createElement('div')
    loader.classList.add('lottie-loader')
    wrapper.appendChild(loader)

    // Lottie –∞–Ω—ñ–º–∞—Ü—ñ—è
    
    const animation = lottie.loadAnimation ({
      container: loader,
      renderer: 'svg',
      loop: true,
      autoplay: true,
      animationData: loaderAnimationData, // ‚úÖ –∑–∞–º—ñ—Å—Ç—å path
    })

    // –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è
    const img = new Image()
    img.src = imgSrc
    img.alt = 'Project image'
    img.classList.add('know-more__block-image')

    // –ü—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ ‚Äî –ø—Ä–∏–±—Ä–∞—Ç–∏ –ª–æ–∞–¥–µ—Ä
    img.onload = () => {
      animation.destroy()
      loader.remove()
    }

    // –Ø–∫—â–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –≤–∂–µ –∫–µ—à–æ–≤–∞–Ω–∞
    if (img.complete) {
      animation.destroy()
      loader.remove()
    }

    wrapper.appendChild(img)
    imagesContainer.appendChild(wrapper)
  })




  // data.image.forEach((imgSrc) => {
  //   const img = document.createElement('img')
  //   img.src = imgSrc
  //   img.alt = 'Project image'
  //   img.classList.add('know-more__block-image')
  //   imagesContainer.appendChild(img)
  // })

  // üé¨ –î–æ–¥–∞—î–º–æ youtube placeholder
  const videoId = extractYouTubeId(data.video)
  videoContainer.innerHTML = `
    <div class="youtube-placeholder" data-video-id="${videoId}">
      <img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="Preview">
      <button class="play-btn">‚ñ∂</button>
    </div>
  `

  // üéØ –°–ª—É—Ö–∞—á –¥–ª—è –∑–∞–ø—É—Å–∫—É –≤—ñ–¥–µ–æ
  const placeholder = videoContainer.querySelector('.youtube-placeholder')
  placeholder.addEventListener('click', () => {
    const iframe = document.createElement('iframe')
    iframe.width = '100%'
    iframe.height = '315'
    iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`
    iframe.frameBorder = '0'
    iframe.allowFullscreen = true
    iframe.allow =
      'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'
    videoContainer.innerHTML = ''
    videoContainer.appendChild(iframe)
  })


  // –ü–æ–∫–∞–∑–∞—Ç–∏ –º–æ–¥–∞–ª–∫—É
  modal.classList.add('active')
  backdrop.classList.add('active')

  const scrollContainer = modal.querySelector('.know-more__scroll')
  scrollContainer.style.scrollBehavior = 'auto'
  scrollContainer.scrollTop = 0
  requestAnimationFrame(() => {
    scrollContainer.style.scrollBehavior = ''
  })

  scrollY = window.scrollY
  const scrollBarWidth = window.innerWidth - document.documentElement.clientWidth
  document.body.style.position = 'fixed'
  document.body.style.top = `-${scrollY}px`
  document.body.style.width = '100%'
  document.body.style.paddingRight = `${scrollBarWidth}px`
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è ID –∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è
function extractYouTubeId(url) {
  const regex = /(?:youtube\.com\/(?:embed\/|watch\?v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/
  const match = url.match(regex)
  return match ? match[1] : null
}



function closeModal() {
  const modal = document.querySelector('.know-more__block')
  const backdrop = document.querySelector('.know-more__behind')

  modal.classList.remove('active')
  backdrop.classList.remove('active')

  // –ó—É–ø–∏–Ω—è—î–º–æ –≤—ñ–¥–µ–æ: –æ—á–∏—â–∞—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
  const videoContainer = modal.querySelector('.know-more__block-video')
  videoContainer.innerHTML = '' // –¶–µ –≥–∞—Ä–∞–Ω—Ç—ñ—è, —â–æ iframe –∑–Ω–∏–∫–∞—î

  // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —Å–∫—Ä–æ–ª –æ–¥—Ä–∞–∑—É
  document.body.style.position = ''
  document.body.style.top = ''
  document.body.style.width = ''
  document.body.style.paddingRight = ''
  window.scrollTo(0, scrollY)
}

function initModalEvents() {
  const closeBtn = document.querySelector('.know-more__block-button')
  if (closeBtn) {
    closeBtn.removeEventListener('click', closeModal) // –Ω–∞ –≤—Å—è–∫ –≤–∏–ø–∞–¥–æ–∫
    closeBtn.addEventListener('click', closeModal)
  }

  const backdrop = document.querySelector('.know-more__behind')
  if (backdrop) {
    backdrop.removeEventListener('click', closeModal)
    backdrop.addEventListener('click', closeModal)
  }
}

// –í—ñ—à–∞—î–º–æ —Å–ª—É—Ö–∞—á—ñ –Ω–∞ –≤—Å—ñ –∫–Ω–æ–ø–∫–∏ "Know more"
function initKnowMoreHandlers() {
  const buttons = document.querySelectorAll('.project-card__button a')
  if (!buttons.length) return

  buttons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault()
      const key = btn.dataset.project
      if (projectsData[key]) {
        openModal(projectsData[key])
      }
    })
  })
}

function initViewAllToggleDesktop() {
  const viewAllBtn = document.querySelector('.project__h2 .btn')
  const projectGrid = document.querySelector('.project-grid')

  if (!viewAllBtn || !projectGrid) return

  const allProjects = Array.from(projectGrid.children)

  // –°—Ö–æ–≤–∞—Ç–∏ –≤—Å—ñ –ø—ñ—Å–ª—è 4-–≥–æ
  allProjects.forEach((el, i) => {
    if (i >= 4) el.style.display = 'none'
  })

  viewAllBtn.addEventListener('click', (e) => {
    e.preventDefault()
    const isOpen = viewAllBtn.classList.toggle('open')

    if (isOpen) {
      allProjects.forEach(el => el.style.display = 'block')
      viewAllBtn.textContent = 'Hide All'

      setTimeout(() => {
        allProjects[4]?.scrollIntoView({ behavior: 'smooth', block: 'center' })
      }, 50)
    } else {
      allProjects.forEach((el, i) => {
        if (i >= 4) el.style.display = 'none'
      })
      viewAllBtn.textContent = 'View All'
    }
  })
}


function initViewAllToggleMobile() {
  const viewAllBtns = document.querySelectorAll('.view-all-btn')
  const projectGrid = document.querySelector('.project-grid')

  if (!viewAllBtns.length || !projectGrid) return

  const allProjects = Array.from(projectGrid.children)

  // –°—Ö–æ–≤–∞—Ç–∏ –∑–∞–π–≤—ñ
  allProjects.forEach((el, i) => {
    if (i >= 4) el.style.display = 'none'
  })

  viewAllBtns.forEach(viewAllBtn => {
    viewAllBtn.addEventListener('click', (e) => {
      e.preventDefault()
      const isOpen = viewAllBtn.classList.toggle('open')

      viewAllBtns.forEach(btn => {
        btn.classList[isOpen ? 'add' : 'remove']('open')
        btn.textContent = isOpen ? 'Hide All' : 'View All'
      })

      if (isOpen) {
        allProjects.forEach(el => el.style.display = 'block')
      } else {
        allProjects.forEach((el, i) => {
          if (i >= 4) el.style.display = 'none'
        })
      }
    })
  })
}


function initLazyYoutube() {
  document.querySelectorAll('.youtube-placeholder').forEach(box => {
    const videoId = box.dataset.videoId

    box.addEventListener('click', () => {
      const iframe = document.createElement('iframe')
      iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`
      iframe.setAttribute('frameborder', '0')
      iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share')
      iframe.setAttribute('allowfullscreen', '')

      box.innerHTML = ''
      box.appendChild(iframe)
    })
  })
}




function initPageComponents() {
  initKnowMoreHandlers()
  initModalEvents()
  initLazyYoutube()

  if (window.innerWidth <= 768) {
    initViewAllToggleMobile()
  } else {
    initViewAllToggleDesktop()
  }
}





// –û–±—Ä–æ–±–∫–∞ –∫–ª—ñ–∫—ñ–≤ –ø–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è—Ö
// –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è —à–ª—è—Ö—É: –ø—Ä–∏–±—Ä–∞—Ç–∏ 'index.html' —Ç–∞ –∫—ñ–Ω—Ü–µ–≤—ñ —Å–ª–µ—à—ñ
function normalizePath(path) {
  return path.replace(/index\.html$/, '').replace(/\/+$/, '')
}
function handleNavigation(event) {
  const link = event.target.closest('a[data-link]')
  if (!link) return

  const href = link.getAttribute('href')
  const [targetPath, targetHash] = href.split('#')
  const [currentPath] = location.pathname.split('#')

  event.preventDefault()

  const normalizedTarget = normalizePath(targetPath || '')
  const normalizedCurrent = normalizePath(currentPath || '')

  // üü° –Ø–∫—â–æ –ø–µ—Ä–µ—Ö—ñ–¥ —Ç—ñ–ª—å–∫–∏ –¥–æ —è–∫–æ—Ä—è –Ω–∞ —Ç—ñ–π —Å–∞–º—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ
  if (normalizedTarget === normalizedCurrent) {
    if (targetHash) {
      const el = document.getElementById(targetHash)
      if (el) el.scrollIntoView({ behavior: 'smooth' })
    }

    // ‚úÖ –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –º–µ–Ω—é –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥—ñ –Ω–∞ —è–∫—ñ—Ä
    if (window.closeBurgerMenu) {
      window.closeBurgerMenu()
    }

    return
  }

  // üîÑ –ü–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ —ñ–Ω—à—É —Å—Ç–æ—Ä—ñ–Ω–∫—É
  history.pushState(null, '', href)

  loadPage(href).then(() => {
    if (window.closeBurgerMenu) {
      window.closeBurgerMenu()
    }
  })
}

// function handleNavigation(event) {
//   const link = event.target.closest('a[data-link]')
//   if (!link) return

//   const href = link.getAttribute('href')
//   const [targetPath, targetHash] = href.split('#')
//   const [currentPath] = location.pathname.split('#')

//   event.preventDefault()

//   if (targetPath === currentPath) {
//     if (targetHash) {
//       const el = document.getElementById(targetHash)
//       if (el) el.scrollIntoView({ behavior: 'smooth' })
//     }
//     return
//   }

//   history.pushState(null, '', href)

//   // ‚úÖ –ó–∞–∫—Ä–∏—î–º–æ –º–µ–Ω—é –ª–∏—à–µ –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
//   loadPage(href).then(() => {
//     if (window.closeBurgerMenu) {
//       window.closeBurgerMenu()
//     }
//   })
// }


// –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫–Ω–æ–ø–∫–∏ "–Ω–∞–∑–∞–¥"
window.addEventListener('popstate', () => {
  loadPage(location.pathname)
})

document.addEventListener('DOMContentLoaded', () => {
  // –ó–±–µ—Ä–µ–≥—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π —à–ª—è—Ö
  lastLoadedPath = location.pathname

  // –û–±—Ä–æ–±–∫–∞ SPA-–ª—ñ–Ω–∫—ñ–≤
  document.body.addEventListener('click', handleNavigation)

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –±—É—Ä–≥–µ—Ä-–º–µ–Ω—é
  if (window.initBurgerMenu) window.initBurgerMenu()

  // –ê–Ω—ñ–º–∞—Ü—ñ—è —Ü–∏—Ñ—Ä (—è–∫—â–æ —î)
  if (window.initNumberAnimation) {
    setTimeout(() => window.initNumberAnimation(), 0)
  }

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —ñ–Ω—à–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
  initPageComponents()

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ Lottie-–ª–æ–∞–¥–µ—Ä–∞
  lottie.loadAnimation({
    container: document.getElementById('lottie-loader'),
    renderer: 'svg',
    loop: true,
    autoplay: true,
    animationData: loaderAnimationData
  })
})

window.addEventListener('popstate', () => {
  loadPage(location.pathname)
})


// document.addEventListener('DOMContentLoaded', () => {
//   lastLoadedPath = location.pathname
//   document.body.addEventListener('click', handleNavigation)

//   if (window.initBurgerMenu) window.initBurgerMenu()
//   if (window.initNumberAnimation) {
//     setTimeout(() => window.initNumberAnimation(), 0)
//   }

//   initPageComponents()
// })

function isSlowConnection() {
  const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection
  if (!connection) return false // –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è ‚Äî –≤–≤–∞–∂–∞—î–º–æ —à–≤–∏–¥–∫–∏–º

  // –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Ç–∏–ø –∑'—î–¥–Ω–∞–Ω–Ω—è: 'slow-2g', '2g', '3g', '4g'
  const slowTypes = ['slow-2g', '2g', '3g']
  return slowTypes.includes(connection.effectiveType)
}

async function loadPage(url) {
  const [path, hash] = url.split('#')

  if (lastLoadedPath === path) {
    if (hash) {
      const el = document.getElementById(hash)
      if (el) el.scrollIntoView({ behavior: 'smooth' })
    }
    return
  }

  const showLoader = isSlowConnection()
  const loader = document.getElementById('page-loader')
  if (showLoader) loader.classList.remove('hidden')

  try {
    const res = await fetch(path)
    const html = await res.text()

    const parser = new DOMParser()
    const doc = parser.parseFromString(html, 'text/html')
    const newContent = doc.querySelector('#app')
    if (!newContent) throw new Error('–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä #app –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ')

    document.querySelector('#app').innerHTML = newContent.innerHTML
    lastLoadedPath = path

    if (window.initBurgerMenu) window.initBurgerMenu()
    if (window.initNumberAnimation) {
      setTimeout(() => window.initNumberAnimation(), 0)
    }

    initPageComponents()

    if (hash) {
      setTimeout(() => {
        const el = document.getElementById(hash)
        if (el) el.scrollIntoView({ behavior: 'smooth' })
      }, 50)
    }

  } catch (e) {
    console.error('Page load error:', e)
    document.querySelector('#app').innerHTML = '<p>Error loading page</p>'
  } finally {
    if (showLoader) {
      setTimeout(() => loader.classList.add('hidden'), 300)
    }
  }
}


// async function loadPage(url) {
//   const loader = document.getElementById('page-loader')
//   loader.classList.remove('hidden') // –ø–æ–∫–∞–∑–∞—Ç–∏ –ª–æ–∞–¥–µ—Ä

//   try {
//     const [path, hash] = url.split('#')

//     if (lastLoadedPath === path) {
//       loader.classList.add('hidden') // —Ö–æ–≤–∞—î–º–æ –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ —Ç—ñ–π —Å–∞–º—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ
//       if (hash) {
//         const el = document.getElementById(hash)
//         if (el) el.scrollIntoView({ behavior: 'smooth' })
//       }
//       return
//     }

//     const res = await fetch(path)
//     const html = await res.text()

//     const parser = new DOMParser()
//     const doc = parser.parseFromString(html, 'text/html')
//     const newContent = doc.querySelector('#app')
//     if (!newContent) throw new Error('–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä #app –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ')

//     document.querySelector('#app').innerHTML = newContent.innerHTML
//     lastLoadedPath = path

//     if (window.initBurgerMenu) window.initBurgerMenu()
//     if (window.initNumberAnimation) {
//       setTimeout(() => window.initNumberAnimation(), 0)
//     }

//     initPageComponents()

//     if (hash) {
//       setTimeout(() => {
//         const el = document.getElementById(hash)
//         if (el) {
//           el.scrollIntoView({ behavior: 'smooth' })
//         }
//       }, 50)
//     }
//   } catch (e) {
//     console.error('Page load error:', e)
//     document.querySelector('#app').innerHTML = '<p>Error loading page</p>'
//   } finally {
//     // ‚è≥ –ø—Ä–∏–±–µ—Ä–∏ –ª–æ–∞–¥–µ—Ä –∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é
//     setTimeout(() => loader.classList.add('hidden'), 300)
//   }
// }
