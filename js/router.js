const loaderAnimationData = {
  "v":"5.8.1","fr":30,"ip":0,"op":33,"w":1920,"h":1080,"nm":"Comp 1","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Shape Layer 5","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"k":[{"s":[1200,472.81,0],"t":0,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,538.525,0],"t":1,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,603.615,0],"t":2,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,658.732,0],"t":3,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,705.957,0],"t":4,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,748.299,0],"t":5,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,787.497,0],"t":6,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,824.536,0],"t":7,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,860,0],"t":8,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,837.624,0],"t":9,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,801.681,0],"t":10,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,764.332,0],"t":11,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,724.315,0],"t":12,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,682.199,0],"t":13,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,643.655,0],"t":14,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,607.961,0],"t":15,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,573.612,0],"t":16,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,540,0],"t":17,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,506.352,0],"t":18,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,471.859,0],"t":19,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,435.787,0],"t":20,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,396.248,0],"t":21,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,351.942,0],"t":22,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,309.615,0],"t":23,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,270.399,0],"t":24,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,232.899,0],"t":25,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,208,0],"t":26,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,244.791,0],"t":27,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,283.209,0],"t":28,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,323.844,0],"t":29,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,367.658,0],"t":30,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,416.366,0],"t":31,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[1200,472.81,0],"t":32,"i":{"x":1,"y":1},"o":{"x":0,"y":0}}],"l":2},"a":{"a":0,"k":[-172,-62,0],"ix":1,"l":2},"s":{"a":0,"k":[190,190,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[60,60],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.901960784314,0.223529411765,0.274509803922,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-172,-62],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":-15,"op":135,"st":-15,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Shape Layer 4","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"k":[{"s":[960,208,0],"t":0,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,244.791,0],"t":1,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,283.209,0],"t":2,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,323.844,0],"t":3,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,367.658,0],"t":4,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,416.366,0],"t":5,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,472.81,0],"t":6,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,538.525,0],"t":7,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,603.615,0],"t":8,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,658.732,0],"t":9,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,705.957,0],"t":10,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,748.299,0],"t":11,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,787.497,0],"t":12,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,824.536,0],"t":13,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,860,0],"t":14,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,837.624,0],"t":15,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,801.681,0],"t":16,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,764.332,0],"t":17,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,724.315,0],"t":18,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,682.199,0],"t":19,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,643.655,0],"t":20,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,607.961,0],"t":21,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,573.612,0],"t":22,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,540,0],"t":23,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,506.352,0],"t":24,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,471.859,0],"t":25,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,435.787,0],"t":26,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,396.248,0],"t":27,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,351.942,0],"t":28,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,309.615,0],"t":29,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,270.399,0],"t":30,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,232.899,0],"t":31,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[960,208,0],"t":32,"i":{"x":1,"y":1},"o":{"x":0,"y":0}}],"l":2},"a":{"a":0,"k":[-172,-62,0],"ix":1,"l":2},"s":{"a":0,"k":[190,190,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[60,60],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.901960784314,0.223529411765,0.274509803922,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-172,-62],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":-9,"op":141,"st":-9,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"Shape Layer 3","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"k":[{"s":[720,540,0],"t":0,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,506.352,0],"t":1,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,471.859,0],"t":2,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,435.787,0],"t":3,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,396.248,0],"t":4,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,351.942,0],"t":5,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,309.615,0],"t":6,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,270.399,0],"t":7,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,232.899,0],"t":8,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,208,0],"t":9,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,244.791,0],"t":10,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,283.209,0],"t":11,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,323.844,0],"t":12,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,367.658,0],"t":13,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,416.366,0],"t":14,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,472.81,0],"t":15,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,538.525,0],"t":16,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,603.615,0],"t":17,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,658.732,0],"t":18,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,705.957,0],"t":19,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,748.299,0],"t":20,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,787.497,0],"t":21,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,824.536,0],"t":22,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,860,0],"t":23,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,837.624,0],"t":24,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,801.681,0],"t":25,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,764.332,0],"t":26,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,724.315,0],"t":27,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,682.199,0],"t":28,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,643.655,0],"t":29,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,607.961,0],"t":30,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,573.612,0],"t":31,"i":{"x":1,"y":1},"o":{"x":0,"y":0}},{"s":[720,540,0],"t":32,"i":{"x":1,"y":1},"o":{"x":0,"y":0}}],"l":2},"a":{"a":0,"k":[-172,-62,0],"ix":1,"l":2},"s":{"a":0,"k":[190,190,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[60,60],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.901960784314,0.223529411765,0.274509803922,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-172,-62],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0}],"markers":[]
}

// Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ– Ñ–Ð½Ñ–Ñ†Ñ–Ð°Ð»Ñ–Ð·Ð°Ñ†Ñ–Ñ—
window.initBurgerMenu = initBurgerMenu

function initBurgerMenu() {
  const burger = document.querySelector('.burger')
  const nav = document.querySelector('nav')
  const navBg = document.querySelector('.nav-bg')
  if (!burger || !nav || !navBg) return

  function closeMenu() {
    nav.classList.remove('open')
    burger.classList.remove('active')
    navBg.classList.remove('visible')
  document.body.classList.remove('no-scroll') // ðŸ”“ Ð´Ð¾Ð·Ð²Ð¾Ð»ÑÑ”Ð¼Ð¾ ÑÐºÑ€Ð¾Ð»
  }

  window.closeBurgerMenu = closeMenu // â¬…ï¸ ÐµÐºÑÐ¿Ð¾Ñ€Ñ‚ÑƒÑ”Ð¼Ð¾ Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾

  burger.addEventListener('click', () => {
    const isOpen = nav.classList.toggle('open')
    burger.classList.toggle('active')
    navBg.classList.toggle('visible', isOpen)
    document.body.classList.toggle('no-scroll', isOpen) // ðŸ”’/ðŸ”“
  })

  nav.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', event => {
      event.preventDefault()
      // Ð½Ð°Ð²Ñ–Ð³Ð°Ñ†Ñ–ÑŽ Ð¾Ð±Ñ€Ð¾Ð±Ð»ÑÑ” handleNavigation
    })
  })
}





// Ð”Ð°Ð½Ñ– Ð²ÑÑ–Ñ… Ð¿Ñ€Ð¾Ñ”ÐºÑ‚Ñ–Ð²
const projectsData = {
  project1: {
    title: "Umedia video 4/5",
    description: "ÐŸÑ€Ð¾Ñ”ÐºÑ‚ Ð¿Ñ€Ð¾ Ð¿Ð¾Ð²ÐµÑ€Ð½ÐµÐ½Ð½Ñ Ð´Ð¾Ð´Ð¾Ð¼Ñƒ Ñ‡ÐµÑ€ÐµÐ· ÐŸÐ°Ñ€Ð¸Ð¶. ÐœÐ¾Ð½Ñ‚Ð°Ð¶, Ñ€Ð¸Ñ‚Ð¼ Ñ– ÐºÐ¾Ð»ÑŒÐ¾Ñ€Ð¾ÐºÐ¾Ñ€ÐµÐºÑ†Ñ–Ñ â€” Ð¼Ð¾Ñ—.",
    video: "https://www.youtube.com/embed/uyOvfzflka0?si=3HdUy981Eu7ibGzr",
    image: [
      "assets/projects_images/1project/about_color.png",
      "assets/projects_images/1project/sound_design.png",
      "assets/projects_images/1project/ae.png",
      "assets/projects_images/1project/ae_subtitles.png",
    ]
  },
  project2: {
    title: "Umedia 1 video",
    description: "Ð•Ð¼Ð¾Ñ†Ñ–Ð¹Ð½Ð° ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ° Ñ–ÑÑ‚Ð¾Ñ€Ñ–Ñ Ð² Instagram-ÑÑ‚Ð¸Ð»Ñ–. ÐŸÑ€Ð°Ñ†ÑŽÐ²Ð°Ð² Ð½Ð°Ð´ Ñ‚ÐµÐ¼Ð¿Ð¾Ð¼ Ñ– Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð°Ð¼Ð¸.",
    video: "https://www.youtube.com/embed/Je7Mc7h1PIg?si=lBBGocJjckXOc9eE",
    image: []
  },
}





// ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚Ð¸ Ð¼Ð¾Ð´Ð°Ð»ÐºÑƒ
let scrollY = 0

function openModal(data) {
  const modal = document.querySelector('.know-more__block')
  const backdrop = document.querySelector('.know-more__behind')

  modal.querySelector('.know-more__block-h1').textContent = data.title
  modal.querySelector('.know-more__block-description-p').textContent = data.description

  const imagesContainer = modal.querySelector('.know-more__block-images')
  const videoContainer = modal.querySelector('.know-more__block-video')

  // ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚Ð¸
  videoContainer.innerHTML = ''
  imagesContainer.querySelectorAll('img').forEach(img => img.remove())

  // Ð”Ð¾Ð´Ð°Ñ‚Ð¸ Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð½Ñ
  data.image.forEach((imgSrc) => {
    // ÐžÐ±Ð³Ð¾Ñ€Ñ‚ÐºÐ°
    const wrapper = document.createElement('div')
    wrapper.classList.add('know-more__block-image-wrapper')

    // Lottie ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€
    const loader = document.createElement('div')
    loader.classList.add('lottie-loader')
    wrapper.appendChild(loader)

    // Lottie Ð°Ð½Ñ–Ð¼Ð°Ñ†Ñ–Ñ
    
    const animation = lottie.loadAnimation ({
      container: loader,
      renderer: 'svg',
      loop: true,
      autoplay: true,
      animationData: loaderAnimationData, // âœ… Ð·Ð°Ð¼Ñ–ÑÑ‚ÑŒ path
    })

    // Ð—Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð½Ñ
    const img = new Image()
    img.src = imgSrc
    img.alt = 'Project image'
    img.classList.add('know-more__block-image')

    // ÐŸÑ€Ð¸ Ð·Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶ÐµÐ½Ð½Ñ– â€” Ð¿Ñ€Ð¸Ð±Ñ€Ð°Ñ‚Ð¸ Ð»Ð¾Ð°Ð´ÐµÑ€
    img.onload = () => {
      animation.destroy()
      loader.remove()
    }

    // Ð¯ÐºÑ‰Ð¾ ÐºÐ°Ñ€Ñ‚Ð¸Ð½ÐºÐ° Ð²Ð¶Ðµ ÐºÐµÑˆÐ¾Ð²Ð°Ð½Ð°
    if (img.complete) {
      animation.destroy()
      loader.remove()
    }

    wrapper.appendChild(img)
    imagesContainer.appendChild(wrapper)
  })




  // data.image.forEach((imgSrc) => {
  //   const img = document.createElement('img')
  //   img.src = imgSrc
  //   img.alt = 'Project image'
  //   img.classList.add('know-more__block-image')
  //   imagesContainer.appendChild(img)
  // })

  // ðŸŽ¬ Ð”Ð¾Ð´Ð°Ñ”Ð¼Ð¾ youtube placeholder
  const videoId = extractYouTubeId(data.video)
  videoContainer.innerHTML = `
    <div class="youtube-placeholder" data-video-id="${videoId}">
      <img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="Preview">
      <button class="play-btn">â–¶</button>
    </div>
  `

  // ðŸŽ¯ Ð¡Ð»ÑƒÑ…Ð°Ñ‡ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÑƒ Ð²Ñ–Ð´ÐµÐ¾
  const placeholder = videoContainer.querySelector('.youtube-placeholder')
  placeholder.addEventListener('click', () => {
    const iframe = document.createElement('iframe')
    iframe.width = '100%'
    iframe.height = '315'
    iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`
    iframe.frameBorder = '0'
    iframe.allowFullscreen = true
    iframe.allow =
      'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'
    videoContainer.innerHTML = ''
    videoContainer.appendChild(iframe)
  })


  // ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚Ð¸ Ð¼Ð¾Ð´Ð°Ð»ÐºÑƒ
  modal.classList.add('active')
  backdrop.classList.add('active')

  const scrollContainer = modal.querySelector('.know-more__scroll')
  scrollContainer.style.scrollBehavior = 'auto'
  scrollContainer.scrollTop = 0
  requestAnimationFrame(() => {
    scrollContainer.style.scrollBehavior = ''
  })

  scrollY = window.scrollY
  const scrollBarWidth = window.innerWidth - document.documentElement.clientWidth
  document.body.style.position = 'fixed'
  document.body.style.top = `-${scrollY}px`
  document.body.style.width = '100%'
  document.body.style.paddingRight = `${scrollBarWidth}px`
}

// Ð¤ÑƒÐ½ÐºÑ†Ñ–Ñ Ð´Ð»Ñ Ð²Ð¸Ñ‚ÑÐ³ÑƒÐ²Ð°Ð½Ð½Ñ ID Ð· Ð¿Ð¾ÑÐ¸Ð»Ð°Ð½Ð½Ñ
function extractYouTubeId(url) {
  const regex = /(?:youtube\.com\/(?:embed\/|watch\?v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/
  const match = url.match(regex)
  return match ? match[1] : null
}



function closeModal() {
  const modal = document.querySelector('.know-more__block')
  const backdrop = document.querySelector('.know-more__behind')

  modal.classList.remove('active')
  backdrop.classList.remove('active')

  // Ð—ÑƒÐ¿Ð¸Ð½ÑÑ”Ð¼Ð¾ Ð²Ñ–Ð´ÐµÐ¾: Ð¾Ñ‡Ð¸Ñ‰Ð°Ñ”Ð¼Ð¾ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€
  const videoContainer = modal.querySelector('.know-more__block-video')
  videoContainer.innerHTML = '' // Ð¦Ðµ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ñ–Ñ, Ñ‰Ð¾ iframe Ð·Ð½Ð¸ÐºÐ°Ñ”

  // ÐŸÐ¾Ð²ÐµÑ€Ñ‚Ð°Ñ”Ð¼Ð¾ ÑÐºÑ€Ð¾Ð» Ð¾Ð´Ñ€Ð°Ð·Ñƒ
  document.body.style.position = ''
  document.body.style.top = ''
  document.body.style.width = ''
  document.body.style.paddingRight = ''
  window.scrollTo(0, scrollY)
}

function initModalEvents() {
  const closeBtn = document.querySelector('.know-more__block-button')
  if (closeBtn) {
    closeBtn.removeEventListener('click', closeModal) // Ð½Ð° Ð²ÑÑÐº Ð²Ð¸Ð¿Ð°Ð´Ð¾Ðº
    closeBtn.addEventListener('click', closeModal)
  }

  const backdrop = document.querySelector('.know-more__behind')
  if (backdrop) {
    backdrop.removeEventListener('click', closeModal)
    backdrop.addEventListener('click', closeModal)
  }
}

// Ð’Ñ–ÑˆÐ°Ñ”Ð¼Ð¾ ÑÐ»ÑƒÑ…Ð°Ñ‡Ñ– Ð½Ð° Ð²ÑÑ– ÐºÐ½Ð¾Ð¿ÐºÐ¸ "Know more"
function initKnowMoreHandlers() {
  const buttons = document.querySelectorAll('.project-card__button a')
  if (!buttons.length) return

  buttons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault()
      const key = btn.dataset.project
      if (projectsData[key]) {
        openModal(projectsData[key])
      }
    })
  })
}

function initViewAllToggleDesktop() {
  const viewAllBtn = document.querySelector('.project__h2 .btn')
  const projectGrid = document.querySelector('.project-grid')

  if (!viewAllBtn || !projectGrid) return

  const allProjects = Array.from(projectGrid.children)

  // Ð¡Ñ…Ð¾Ð²Ð°Ñ‚Ð¸ Ð²ÑÑ– Ð¿Ñ–ÑÐ»Ñ 4-Ð³Ð¾
  allProjects.forEach((el, i) => {
    if (i >= 4) el.style.display = 'none'
  })

  viewAllBtn.addEventListener('click', (e) => {
    e.preventDefault()
    const isOpen = viewAllBtn.classList.toggle('open')

    if (isOpen) {
      allProjects.forEach(el => el.style.display = 'block')
      viewAllBtn.textContent = 'Hide All'

      setTimeout(() => {
        allProjects[4]?.scrollIntoView({ behavior: 'smooth', block: 'center' })
      }, 50)
    } else {
      allProjects.forEach((el, i) => {
        if (i >= 4) el.style.display = 'none'
      })
      viewAllBtn.textContent = 'View All'
    }
  })
}


function initViewAllToggleMobile() {
  const viewAllBtns = document.querySelectorAll('.view-all-btn')
  const projectGrid = document.querySelector('.project-grid')

  if (!viewAllBtns.length || !projectGrid) return

  const allProjects = Array.from(projectGrid.children)

  // Ð¡Ñ…Ð¾Ð²Ð°Ñ‚Ð¸ Ð·Ð°Ð¹Ð²Ñ–
  allProjects.forEach((el, i) => {
    if (i >= 4) el.style.display = 'none'
  })

  viewAllBtns.forEach(viewAllBtn => {
    viewAllBtn.addEventListener('click', (e) => {
      e.preventDefault()
      const isOpen = viewAllBtn.classList.toggle('open')

      viewAllBtns.forEach(btn => {
        btn.classList[isOpen ? 'add' : 'remove']('open')
        btn.textContent = isOpen ? 'Hide All' : 'View All'
      })

      if (isOpen) {
        allProjects.forEach(el => el.style.display = 'block')
      } else {
        allProjects.forEach((el, i) => {
          if (i >= 4) el.style.display = 'none'
        })
      }
    })
  })
}


function initLazyYoutube() {
  document.querySelectorAll('.youtube-placeholder').forEach(box => {
    const videoId = box.dataset.videoId

    box.addEventListener('click', () => {
      const iframe = document.createElement('iframe')
      iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`
      iframe.setAttribute('frameborder', '0')
      iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share')
      iframe.setAttribute('allowfullscreen', '')

      box.innerHTML = ''
      box.appendChild(iframe)
    })
  })
}




function initPageComponents() {
  initKnowMoreHandlers()
  initModalEvents()
  initLazyYoutube()

  if (window.innerWidth <= 768) {
    initViewAllToggleMobile()
  } else {
    initViewAllToggleDesktop()
  }
}





// ÐžÐ±Ñ€Ð¾Ð±ÐºÐ° ÐºÐ»Ñ–ÐºÑ–Ð² Ð¿Ð¾ Ð¿Ð¾ÑÐ¸Ð»Ð°Ð½Ð½ÑÑ…
// ÐÐ¾Ñ€Ð¼Ð°Ð»Ñ–Ð·Ð°Ñ†Ñ–Ñ ÑˆÐ»ÑÑ…Ñƒ: Ð¿Ñ€Ð¸Ð±Ñ€Ð°Ñ‚Ð¸ 'index.html' Ñ‚Ð° ÐºÑ–Ð½Ñ†ÐµÐ²Ñ– ÑÐ»ÐµÑˆÑ–
function normalizePath(path) {
  return path.replace(/index\.html$/, '').replace(/\/+$/, '')
}
function handleNavigation(event) {
  const link = event.target.closest('a[data-link]')
  if (!link) return

  const href = link.getAttribute('href')
  const [targetPath, targetHash] = href.split('#')
  const [currentPath] = location.pathname.split('#')

  event.preventDefault()

  const normalizedTarget = normalizePath(targetPath || '')
  const normalizedCurrent = normalizePath(currentPath || '')

  // ðŸŸ¡ Ð¯ÐºÑ‰Ð¾ Ð¿ÐµÑ€ÐµÑ…Ñ–Ð´ Ñ‚Ñ–Ð»ÑŒÐºÐ¸ Ð´Ð¾ ÑÐºÐ¾Ñ€Ñ Ð½Ð° Ñ‚Ñ–Ð¹ ÑÐ°Ð¼Ñ–Ð¹ ÑÑ‚Ð¾Ñ€Ñ–Ð½Ñ†Ñ–
  if (normalizedTarget === normalizedCurrent) {
    if (targetHash) {
      const el = document.getElementById(targetHash)
      if (el) el.scrollIntoView({ behavior: 'smooth' })
    }

    // âœ… Ð—Ð°ÐºÑ€Ð¸Ð²Ð°Ñ”Ð¼Ð¾ Ð¼ÐµÐ½ÑŽ Ð½Ð°Ð²Ñ–Ñ‚ÑŒ Ð¿Ñ€Ð¸ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ñ– Ð½Ð° ÑÐºÑ–Ñ€
    if (window.closeBurgerMenu) {
      window.closeBurgerMenu()
    }

    return
  }

  // ðŸ”„ ÐŸÐµÑ€ÐµÑ…Ñ–Ð´ Ð½Ð° Ñ–Ð½ÑˆÑƒ ÑÑ‚Ð¾Ñ€Ñ–Ð½ÐºÑƒ
  history.pushState(null, '', href)

  loadPage(href).then(() => {
    if (window.closeBurgerMenu) {
      window.closeBurgerMenu()
    }
  })
}

// function handleNavigation(event) {
//   const link = event.target.closest('a[data-link]')
//   if (!link) return

//   const href = link.getAttribute('href')
//   const [targetPath, targetHash] = href.split('#')
//   const [currentPath] = location.pathname.split('#')

//   event.preventDefault()

//   if (targetPath === currentPath) {
//     if (targetHash) {
//       const el = document.getElementById(targetHash)
//       if (el) el.scrollIntoView({ behavior: 'smooth' })
//     }
//     return
//   }

//   history.pushState(null, '', href)

//   // âœ… Ð—Ð°ÐºÑ€Ð¸Ñ”Ð¼Ð¾ Ð¼ÐµÐ½ÑŽ Ð»Ð¸ÑˆÐµ Ð¿Ñ–ÑÐ»Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ Ð·Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶ÐµÐ½Ð½Ñ
//   loadPage(href).then(() => {
//     if (window.closeBurgerMenu) {
//       window.closeBurgerMenu()
//     }
//   })
// }


// ÐŸÑ–Ð´Ñ‚Ñ€Ð¸Ð¼ÐºÐ° ÐºÐ½Ð¾Ð¿ÐºÐ¸ "Ð½Ð°Ð·Ð°Ð´"
window.addEventListener('popstate', () => {
  loadPage(location.pathname)
})

document.addEventListener('DOMContentLoaded', () => {
  // Ð—Ð±ÐµÑ€ÐµÐ³Ñ‚Ð¸ Ð¿Ð¾Ñ‚Ð¾Ñ‡Ð½Ð¸Ð¹ ÑˆÐ»ÑÑ…
  lastLoadedPath = location.pathname

  // ÐžÐ±Ñ€Ð¾Ð±ÐºÐ° SPA-Ð»Ñ–Ð½ÐºÑ–Ð²
  document.body.addEventListener('click', handleNavigation)

  // Ð†Ð½Ñ–Ñ†Ñ–Ð°Ð»Ñ–Ð·Ð°Ñ†Ñ–Ñ Ð±ÑƒÑ€Ð³ÐµÑ€-Ð¼ÐµÐ½ÑŽ
  if (window.initBurgerMenu) window.initBurgerMenu()

  // ÐÐ½Ñ–Ð¼Ð°Ñ†Ñ–Ñ Ñ†Ð¸Ñ„Ñ€ (ÑÐºÑ‰Ð¾ Ñ”)
  if (window.initNumberAnimation) {
    setTimeout(() => window.initNumberAnimation(), 0)
  }

  // Ð†Ð½Ñ–Ñ†Ñ–Ð°Ð»Ñ–Ð·Ð°Ñ†Ñ–Ñ Ñ–Ð½ÑˆÐ¸Ñ… ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ–Ð² ÑÑ‚Ð¾Ñ€Ñ–Ð½ÐºÐ¸
  initPageComponents()

  // Ð†Ð½Ñ–Ñ†Ñ–Ð°Ð»Ñ–Ð·Ð°Ñ†Ñ–Ñ Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Lottie-Ð»Ð¾Ð°Ð´ÐµÑ€Ð°
  lottie.loadAnimation({
    container: document.getElementById('lottie-loader'),
    renderer: 'svg',
    loop: true,
    autoplay: true,
    animationData: loaderAnimationData
  })
})

window.addEventListener('popstate', () => {
  loadPage(location.pathname)
})


// document.addEventListener('DOMContentLoaded', () => {
//   lastLoadedPath = location.pathname
//   document.body.addEventListener('click', handleNavigation)

//   if (window.initBurgerMenu) window.initBurgerMenu()
//   if (window.initNumberAnimation) {
//     setTimeout(() => window.initNumberAnimation(), 0)
//   }

//   initPageComponents()
// })

function isSlowConnection() {
  const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection
  if (!connection) return false // Ð½Ðµ Ð¿Ñ–Ð´Ñ‚Ñ€Ð¸Ð¼ÑƒÑ”Ñ‚ÑŒÑÑ â€” Ð²Ð²Ð°Ð¶Ð°Ñ”Ð¼Ð¾ ÑˆÐ²Ð¸Ð´ÐºÐ¸Ð¼

  // ÐÐ°Ð¿Ñ€Ð¸ÐºÐ»Ð°Ð´, Ñ‚Ð¸Ð¿ Ð·'Ñ”Ð´Ð½Ð°Ð½Ð½Ñ: 'slow-2g', '2g', '3g', '4g'
  const slowTypes = ['slow-2g', '2g', '3g']
  return slowTypes.includes(connection.effectiveType)
}

async function loadPage(url) {
  const [path, hash] = url.split('#')

  if (lastLoadedPath === path) {
    if (hash) {
      const el = document.getElementById(hash)
      if (el) el.scrollIntoView({ behavior: 'smooth' })
    }
    return
  }

  const showLoader = isSlowConnection()
  const loader = document.getElementById('page-loader')
  if (showLoader) loader.classList.remove('hidden')

  try {
    const res = await fetch(path)
    const html = await res.text()

    const parser = new DOMParser()
    const doc = parser.parseFromString(html, 'text/html')
    const newContent = doc.querySelector('#app')
    if (!newContent) throw new Error('ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ #app Ð½Ðµ Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾')

    document.querySelector('#app').innerHTML = newContent.innerHTML
    lastLoadedPath = path

    if (window.initBurgerMenu) window.initBurgerMenu()
    if (window.initNumberAnimation) {
      setTimeout(() => window.initNumberAnimation(), 0)
    }

    initPageComponents()

    if (hash) {
      setTimeout(() => {
        const el = document.getElementById(hash)
        if (el) el.scrollIntoView({ behavior: 'smooth' })
      }, 50)
    }

  } catch (e) {
    console.error('Page load error:', e)
    document.querySelector('#app').innerHTML = '<p>Error loading page</p>'
  } finally {
    if (showLoader) {
      setTimeout(() => loader.classList.add('hidden'), 300)
    }
  }
}


// async function loadPage(url) {
//   const loader = document.getElementById('page-loader')
//   loader.classList.remove('hidden') // Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚Ð¸ Ð»Ð¾Ð°Ð´ÐµÑ€

//   try {
//     const [path, hash] = url.split('#')

//     if (lastLoadedPath === path) {
//       loader.classList.add('hidden') // Ñ…Ð¾Ð²Ð°Ñ”Ð¼Ð¾ Ð½Ð°Ð²Ñ–Ñ‚ÑŒ Ð¿Ñ€Ð¸ Ñ‚Ñ–Ð¹ ÑÐ°Ð¼Ñ–Ð¹ ÑÑ‚Ð¾Ñ€Ñ–Ð½Ñ†Ñ–
//       if (hash) {
//         const el = document.getElementById(hash)
//         if (el) el.scrollIntoView({ behavior: 'smooth' })
//       }
//       return
//     }

//     const res = await fetch(path)
//     const html = await res.text()

//     const parser = new DOMParser()
//     const doc = parser.parseFromString(html, 'text/html')
//     const newContent = doc.querySelector('#app')
//     if (!newContent) throw new Error('ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ #app Ð½Ðµ Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾')

//     document.querySelector('#app').innerHTML = newContent.innerHTML
//     lastLoadedPath = path

//     if (window.initBurgerMenu) window.initBurgerMenu()
//     if (window.initNumberAnimation) {
//       setTimeout(() => window.initNumberAnimation(), 0)
//     }

//     initPageComponents()

//     if (hash) {
//       setTimeout(() => {
//         const el = document.getElementById(hash)
//         if (el) {
//           el.scrollIntoView({ behavior: 'smooth' })
//         }
//       }, 50)
//     }
//   } catch (e) {
//     console.error('Page load error:', e)
//     document.querySelector('#app').innerHTML = '<p>Error loading page</p>'
//   } finally {
//     // â³ Ð¿Ñ€Ð¸Ð±ÐµÑ€Ð¸ Ð»Ð¾Ð°Ð´ÐµÑ€ Ð· Ð·Ð°Ñ‚Ñ€Ð¸Ð¼ÐºÐ¾ÑŽ
//     setTimeout(() => loader.classList.add('hidden'), 300)
//   }
// }
